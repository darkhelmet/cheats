
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../inquirer/">
      
      
        <link rel="next" href="../langchain/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.17">
    
    
      
        <title>Keras - Cheat Sheets</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.bcfcd587.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#keras" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Cheat Sheets" class="md-header__button md-logo" aria-label="Cheat Sheets" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Cheat Sheets
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Keras
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Cheat Sheets" class="md-nav__button md-logo" aria-label="Cheat Sheets" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Cheat Sheets
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cheat Sheets Collection
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../machine-learning-algorithms/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Machine Learning Algorithms
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Gpu
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Gpu
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gpu/cuda/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CUDA Programming
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Javascript
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Javascript
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../javascript/nextjs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Next.js
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../javascript/react/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    React
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Os
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Os
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../os/bottlerocket/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bottlerocket OS Administration
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Python
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Python
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../inquirer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python Inquirer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Keras
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Keras
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    <span class="md-ellipsis">
      Installation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Backend Configuration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#import-essentials" class="md-nav__link">
    <span class="md-ellipsis">
      Import Essentials
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#models" class="md-nav__link">
    <span class="md-ellipsis">
      Models
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sequential-model" class="md-nav__link">
    <span class="md-ellipsis">
      Sequential Model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#functional-api" class="md-nav__link">
    <span class="md-ellipsis">
      Functional API
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#model-subclassing" class="md-nav__link">
    <span class="md-ellipsis">
      Model Subclassing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#layers" class="md-nav__link">
    <span class="md-ellipsis">
      Layers
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Layers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dense-fully-connected" class="md-nav__link">
    <span class="md-ellipsis">
      Dense (Fully Connected)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#convolutional-layers" class="md-nav__link">
    <span class="md-ellipsis">
      Convolutional Layers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pooling-layers" class="md-nav__link">
    <span class="md-ellipsis">
      Pooling Layers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recurrent-layers" class="md-nav__link">
    <span class="md-ellipsis">
      Recurrent Layers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attention-and-transformer-layers" class="md-nav__link">
    <span class="md-ellipsis">
      Attention and Transformer Layers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#normalization-layers" class="md-nav__link">
    <span class="md-ellipsis">
      Normalization Layers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#regularization" class="md-nav__link">
    <span class="md-ellipsis">
      Regularization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#activation-layers" class="md-nav__link">
    <span class="md-ellipsis">
      Activation Layers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#utility-layers" class="md-nav__link">
    <span class="md-ellipsis">
      Utility Layers
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model-compilation" class="md-nav__link">
    <span class="md-ellipsis">
      Model Compilation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Model Compilation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-compilation" class="md-nav__link">
    <span class="md-ellipsis">
      Basic Compilation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Custom Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multiple-losses-multi-output" class="md-nav__link">
    <span class="md-ellipsis">
      Multiple Losses (Multi-output)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#optimizers" class="md-nav__link">
    <span class="md-ellipsis">
      Optimizers
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Optimizers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#learning-rate-schedules" class="md-nav__link">
    <span class="md-ellipsis">
      Learning Rate Schedules
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#loss-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Loss Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Loss Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#classification" class="md-nav__link">
    <span class="md-ellipsis">
      Classification
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#regression" class="md-nav__link">
    <span class="md-ellipsis">
      Regression
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-loss" class="md-nav__link">
    <span class="md-ellipsis">
      Custom Loss
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#training" class="md-nav__link">
    <span class="md-ellipsis">
      Training
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Training">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-training" class="md-nav__link">
    <span class="md-ellipsis">
      Basic Training
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced-training-with-callbacks" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced Training with Callbacks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-training-step" class="md-nav__link">
    <span class="md-ellipsis">
      Custom Training Step
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-processing" class="md-nav__link">
    <span class="md-ellipsis">
      Data Processing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Data Processing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#image-data-loading-and-augmentation" class="md-nav__link">
    <span class="md-ellipsis">
      Image Data Loading and Augmentation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tfdata-integration" class="md-nav__link">
    <span class="md-ellipsis">
      tf.data Integration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evaluation-and-prediction" class="md-nav__link">
    <span class="md-ellipsis">
      Evaluation and Prediction
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Evaluation and Prediction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#model-evaluation" class="md-nav__link">
    <span class="md-ellipsis">
      Model Evaluation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#predictions" class="md-nav__link">
    <span class="md-ellipsis">
      Predictions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model-persistence" class="md-nav__link">
    <span class="md-ellipsis">
      Model Persistence
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Model Persistence">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#saveload-model" class="md-nav__link">
    <span class="md-ellipsis">
      Save/Load Model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#export-to-different-formats" class="md-nav__link">
    <span class="md-ellipsis">
      Export to Different Formats
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#callbacks" class="md-nav__link">
    <span class="md-ellipsis">
      Callbacks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Callbacks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#built-in-callbacks" class="md-nav__link">
    <span class="md-ellipsis">
      Built-in Callbacks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-callbacks" class="md-nav__link">
    <span class="md-ellipsis">
      Custom Callbacks
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metrics" class="md-nav__link">
    <span class="md-ellipsis">
      Metrics
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Metrics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#built-in-metrics" class="md-nav__link">
    <span class="md-ellipsis">
      Built-in Metrics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-metrics" class="md-nav__link">
    <span class="md-ellipsis">
      Custom Metrics
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#transfer-learning" class="md-nav__link">
    <span class="md-ellipsis">
      Transfer Learning
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Transfer Learning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-pre-trained-models" class="md-nav__link">
    <span class="md-ellipsis">
      Using Pre-trained Models
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-features" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced Features
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Advanced Features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mixed-precision-training" class="md-nav__link">
    <span class="md-ellipsis">
      Mixed Precision Training
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-layers" class="md-nav__link">
    <span class="md-ellipsis">
      Custom Layers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#model-visualization" class="md-nav__link">
    <span class="md-ellipsis">
      Model Visualization
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hyperparameter-tuning-with-kerastuner" class="md-nav__link">
    <span class="md-ellipsis">
      Hyperparameter Tuning with KerasTuner
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kerashub-and-kerascv" class="md-nav__link">
    <span class="md-ellipsis">
      KerasHub and KerasCV
    </span>
  </a>
  
    <nav class="md-nav" aria-label="KerasHub and KerasCV">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerashub-nlp" class="md-nav__link">
    <span class="md-ellipsis">
      KerasHub (NLP)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerascv-computer-vision" class="md-nav__link">
    <span class="md-ellipsis">
      KerasCV (Computer Vision)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#debugging-and-performance" class="md-nav__link">
    <span class="md-ellipsis">
      Debugging and Performance
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Debugging and Performance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#debugging" class="md-nav__link">
    <span class="md-ellipsis">
      Debugging
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#performance-optimization" class="md-nav__link">
    <span class="md-ellipsis">
      Performance Optimization
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Best Practices
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../langchain/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LangChain
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../langextract/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LangExtract
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../matplotlib/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Matplotlib
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../nltk/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NLTK (Natural Language Toolkit)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../numpy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NumPy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pandas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pandas
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pillow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pillow (PIL)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../polars/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Polars
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../python/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pytorch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTorch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../scikit-learn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Scikit-learn
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../scipy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SciPy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../seaborn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Seaborn
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sentence-transformers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sentence-Transformers (UKPLab)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tensorflow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TensorFlow
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../torchvision/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TorchVision
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../transformers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transformers (Hugging Face)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tools
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Tools
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/protobuf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Protocol Buffers (protobuf)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/ripgrep/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ripgrep (rg)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/vim-lazyvim/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vim/Neovim with LazyVim
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    <span class="md-ellipsis">
      Installation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Backend Configuration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#import-essentials" class="md-nav__link">
    <span class="md-ellipsis">
      Import Essentials
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#models" class="md-nav__link">
    <span class="md-ellipsis">
      Models
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sequential-model" class="md-nav__link">
    <span class="md-ellipsis">
      Sequential Model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#functional-api" class="md-nav__link">
    <span class="md-ellipsis">
      Functional API
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#model-subclassing" class="md-nav__link">
    <span class="md-ellipsis">
      Model Subclassing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#layers" class="md-nav__link">
    <span class="md-ellipsis">
      Layers
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Layers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dense-fully-connected" class="md-nav__link">
    <span class="md-ellipsis">
      Dense (Fully Connected)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#convolutional-layers" class="md-nav__link">
    <span class="md-ellipsis">
      Convolutional Layers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pooling-layers" class="md-nav__link">
    <span class="md-ellipsis">
      Pooling Layers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recurrent-layers" class="md-nav__link">
    <span class="md-ellipsis">
      Recurrent Layers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attention-and-transformer-layers" class="md-nav__link">
    <span class="md-ellipsis">
      Attention and Transformer Layers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#normalization-layers" class="md-nav__link">
    <span class="md-ellipsis">
      Normalization Layers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#regularization" class="md-nav__link">
    <span class="md-ellipsis">
      Regularization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#activation-layers" class="md-nav__link">
    <span class="md-ellipsis">
      Activation Layers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#utility-layers" class="md-nav__link">
    <span class="md-ellipsis">
      Utility Layers
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model-compilation" class="md-nav__link">
    <span class="md-ellipsis">
      Model Compilation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Model Compilation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-compilation" class="md-nav__link">
    <span class="md-ellipsis">
      Basic Compilation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Custom Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multiple-losses-multi-output" class="md-nav__link">
    <span class="md-ellipsis">
      Multiple Losses (Multi-output)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#optimizers" class="md-nav__link">
    <span class="md-ellipsis">
      Optimizers
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Optimizers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#learning-rate-schedules" class="md-nav__link">
    <span class="md-ellipsis">
      Learning Rate Schedules
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#loss-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Loss Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Loss Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#classification" class="md-nav__link">
    <span class="md-ellipsis">
      Classification
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#regression" class="md-nav__link">
    <span class="md-ellipsis">
      Regression
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-loss" class="md-nav__link">
    <span class="md-ellipsis">
      Custom Loss
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#training" class="md-nav__link">
    <span class="md-ellipsis">
      Training
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Training">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-training" class="md-nav__link">
    <span class="md-ellipsis">
      Basic Training
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced-training-with-callbacks" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced Training with Callbacks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-training-step" class="md-nav__link">
    <span class="md-ellipsis">
      Custom Training Step
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-processing" class="md-nav__link">
    <span class="md-ellipsis">
      Data Processing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Data Processing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#image-data-loading-and-augmentation" class="md-nav__link">
    <span class="md-ellipsis">
      Image Data Loading and Augmentation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tfdata-integration" class="md-nav__link">
    <span class="md-ellipsis">
      tf.data Integration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evaluation-and-prediction" class="md-nav__link">
    <span class="md-ellipsis">
      Evaluation and Prediction
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Evaluation and Prediction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#model-evaluation" class="md-nav__link">
    <span class="md-ellipsis">
      Model Evaluation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#predictions" class="md-nav__link">
    <span class="md-ellipsis">
      Predictions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model-persistence" class="md-nav__link">
    <span class="md-ellipsis">
      Model Persistence
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Model Persistence">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#saveload-model" class="md-nav__link">
    <span class="md-ellipsis">
      Save/Load Model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#export-to-different-formats" class="md-nav__link">
    <span class="md-ellipsis">
      Export to Different Formats
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#callbacks" class="md-nav__link">
    <span class="md-ellipsis">
      Callbacks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Callbacks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#built-in-callbacks" class="md-nav__link">
    <span class="md-ellipsis">
      Built-in Callbacks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-callbacks" class="md-nav__link">
    <span class="md-ellipsis">
      Custom Callbacks
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metrics" class="md-nav__link">
    <span class="md-ellipsis">
      Metrics
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Metrics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#built-in-metrics" class="md-nav__link">
    <span class="md-ellipsis">
      Built-in Metrics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-metrics" class="md-nav__link">
    <span class="md-ellipsis">
      Custom Metrics
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#transfer-learning" class="md-nav__link">
    <span class="md-ellipsis">
      Transfer Learning
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Transfer Learning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-pre-trained-models" class="md-nav__link">
    <span class="md-ellipsis">
      Using Pre-trained Models
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-features" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced Features
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Advanced Features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mixed-precision-training" class="md-nav__link">
    <span class="md-ellipsis">
      Mixed Precision Training
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-layers" class="md-nav__link">
    <span class="md-ellipsis">
      Custom Layers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#model-visualization" class="md-nav__link">
    <span class="md-ellipsis">
      Model Visualization
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hyperparameter-tuning-with-kerastuner" class="md-nav__link">
    <span class="md-ellipsis">
      Hyperparameter Tuning with KerasTuner
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kerashub-and-kerascv" class="md-nav__link">
    <span class="md-ellipsis">
      KerasHub and KerasCV
    </span>
  </a>
  
    <nav class="md-nav" aria-label="KerasHub and KerasCV">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kerashub-nlp" class="md-nav__link">
    <span class="md-ellipsis">
      KerasHub (NLP)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerascv-computer-vision" class="md-nav__link">
    <span class="md-ellipsis">
      KerasCV (Computer Vision)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#debugging-and-performance" class="md-nav__link">
    <span class="md-ellipsis">
      Debugging and Performance
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Debugging and Performance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#debugging" class="md-nav__link">
    <span class="md-ellipsis">
      Debugging
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#performance-optimization" class="md-nav__link">
    <span class="md-ellipsis">
      Performance Optimization
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Best Practices
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="keras">Keras</h1>
<h2 id="installation">Installation</h2>
<pre><code class="language-bash"># Keras 3 (multi-backend)
pip install --upgrade keras

# With specific backend dependencies
pip install --upgrade keras-cv keras-hub keras  # For computer vision and NLP
pip install --upgrade jax[cpu]    # For JAX backend
pip install --upgrade tensorflow  # For TensorFlow backend  
pip install --upgrade torch       # For PyTorch backend

# Check version
python -c &quot;import keras; print(keras.__version__)&quot;
</code></pre>
<h2 id="backend-configuration">Backend Configuration</h2>
<pre><code class="language-python"># Set backend before importing Keras (method 1)
import os
os.environ[&quot;KERAS_BACKEND&quot;] = &quot;tensorflow&quot;  # or &quot;jax&quot;, &quot;torch&quot;

# Or via environment variable (method 2)
export KERAS_BACKEND=&quot;jax&quot;

# Or in Colab/Jupyter
import os
os.environ[&quot;KERAS_BACKEND&quot;] = &quot;jax&quot;
import keras

# Check current backend
print(keras.config.backend())
</code></pre>
<h2 id="import-essentials">Import Essentials</h2>
<pre><code class="language-python">import keras
from keras import layers, models, utils, optimizers, losses, metrics
from keras import ops  # Backend-agnostic operations
import numpy as np
import matplotlib.pyplot as plt
</code></pre>
<h2 id="models">Models</h2>
<h3 id="sequential-model">Sequential Model</h3>
<pre><code class="language-python"># Method 1: List of layers
model = keras.Sequential([
    layers.Dense(64, activation='relu', input_shape=(784,)),
    layers.Dropout(0.2),
    layers.Dense(10, activation='softmax')
])

# Method 2: Add layers incrementally
model = keras.Sequential()
model.add(layers.Dense(64, activation='relu', input_shape=(784,)))
model.add(layers.Dropout(0.2))
model.add(layers.Dense(10, activation='softmax'))
</code></pre>
<h3 id="functional-api">Functional API</h3>
<pre><code class="language-python">inputs = layers.Input(shape=(784,))
x = layers.Dense(64, activation='relu')(inputs)
x = layers.Dropout(0.2)(x)
outputs = layers.Dense(10, activation='softmax')(x)

model = keras.Model(inputs=inputs, outputs=outputs)

# Multi-input/output example
input1 = layers.Input(shape=(10,), name='input1')
input2 = layers.Input(shape=(5,), name='input2')

x1 = layers.Dense(64, activation='relu')(input1)
x2 = layers.Dense(32, activation='relu')(input2)

concatenated = layers.Concatenate()([x1, x2])
output1 = layers.Dense(1, activation='sigmoid', name='output1')(concatenated)
output2 = layers.Dense(3, activation='softmax', name='output2')(concatenated)

model = keras.Model(inputs=[input1, input2], outputs=[output1, output2])
</code></pre>
<h3 id="model-subclassing">Model Subclassing</h3>
<pre><code class="language-python">class MyModel(keras.Model):
    def __init__(self, num_classes=10):
        super().__init__()
        self.dense1 = layers.Dense(64, activation='relu')
        self.dropout = layers.Dropout(0.2)
        self.dense2 = layers.Dense(num_classes, activation='softmax')

    def call(self, inputs, training=None):
        x = self.dense1(inputs)
        x = self.dropout(x, training=training)
        return self.dense2(x)

    def get_config(self):
        return {&quot;num_classes&quot;: self.dense2.units}

model = MyModel(num_classes=10)
</code></pre>
<h2 id="layers">Layers</h2>
<h3 id="dense-fully-connected">Dense (Fully Connected)</h3>
<pre><code class="language-python">layers.Dense(64, activation='relu')
layers.Dense(10, activation='softmax', use_bias=False)
layers.Dense(32, kernel_regularizer=keras.regularizers.l2(0.01))
</code></pre>
<h3 id="convolutional-layers">Convolutional Layers</h3>
<pre><code class="language-python"># 2D Convolution
layers.Conv2D(32, (3, 3), activation='relu', padding='same')
layers.Conv2D(64, 3, strides=2, activation='relu')

# Depthwise Separable
layers.SeparableConv2D(64, (3, 3), activation='relu')

# Transposed Convolution (Deconvolution)
layers.Conv2DTranspose(32, (3, 3), strides=2, padding='same')

# 1D and 3D variants
layers.Conv1D(32, 3, activation='relu')
layers.Conv3D(32, (3, 3, 3), activation='relu')
</code></pre>
<h3 id="pooling-layers">Pooling Layers</h3>
<pre><code class="language-python">layers.MaxPooling2D((2, 2))
layers.AveragePooling2D((2, 2), strides=2)
layers.GlobalMaxPooling2D()
layers.GlobalAveragePooling2D()
</code></pre>
<h3 id="recurrent-layers">Recurrent Layers</h3>
<pre><code class="language-python">layers.LSTM(64, return_sequences=True)
layers.GRU(32, dropout=0.2, recurrent_dropout=0.2)
layers.SimpleRNN(32)

# Bidirectional
layers.Bidirectional(layers.LSTM(64))

# Stacked RNNs
layers.LSTM(64, return_sequences=True)
layers.LSTM(32)
</code></pre>
<h3 id="attention-and-transformer-layers">Attention and Transformer Layers</h3>
<pre><code class="language-python"># Multi-head attention
layers.MultiHeadAttention(num_heads=8, key_dim=64)

# Self-attention
layers.Attention()

# Add &amp; Normalize
layers.LayerNormalization()
layers.Add()
</code></pre>
<h3 id="normalization-layers">Normalization Layers</h3>
<pre><code class="language-python">layers.BatchNormalization()
layers.LayerNormalization()
layers.GroupNormalization(groups=32)
layers.UnitNormalization()
</code></pre>
<h3 id="regularization">Regularization</h3>
<pre><code class="language-python">layers.Dropout(0.2)
layers.AlphaDropout(0.1)  # For SELU activation
layers.SpatialDropout2D(0.2)  # For convolutional layers
layers.GaussianDropout(0.1)
layers.GaussianNoise(0.1)
</code></pre>
<h3 id="activation-layers">Activation Layers</h3>
<pre><code class="language-python">layers.ReLU()
layers.LeakyReLU(negative_slope=0.3)
layers.ELU(alpha=1.0)
layers.Softmax(axis=-1)
layers.Activation('tanh')

# Advanced activations
layers.PReLU()
layers.ThresholdedReLU(theta=1.0)
layers.Softplus()
</code></pre>
<h3 id="utility-layers">Utility Layers</h3>
<pre><code class="language-python">layers.Flatten()
layers.Reshape((3, 4))
layers.Permute((2, 1))
layers.RepeatVector(3)
layers.Lambda(lambda x: x ** 2)
layers.Cropping2D(cropping=((1, 1), (2, 2)))
layers.ZeroPadding2D(padding=(1, 1))
</code></pre>
<h2 id="model-compilation">Model Compilation</h2>
<h3 id="basic-compilation">Basic Compilation</h3>
<pre><code class="language-python">model.compile(
    optimizer='adam',
    loss='sparse_categorical_crossentropy',
    metrics=['accuracy']
)
</code></pre>
<h3 id="custom-configuration">Custom Configuration</h3>
<pre><code class="language-python">model.compile(
    optimizer=keras.optimizers.Adam(learning_rate=0.001, beta_1=0.9, beta_2=0.999),
    loss=keras.losses.SparseCategoricalCrossentropy(from_logits=True),
    metrics=[
        keras.metrics.SparseCategoricalAccuracy(),
        keras.metrics.TopKCategoricalAccuracy(k=5)
    ]
)
</code></pre>
<h3 id="multiple-losses-multi-output">Multiple Losses (Multi-output)</h3>
<pre><code class="language-python">model.compile(
    optimizer='adam',
    loss={
        'output1': 'binary_crossentropy',
        'output2': 'categorical_crossentropy'
    },
    loss_weights={'output1': 1.0, 'output2': 0.2},
    metrics={
        'output1': ['accuracy'],
        'output2': ['accuracy', 'top_k_categorical_accuracy']
    }
)
</code></pre>
<h2 id="optimizers">Optimizers</h2>
<pre><code class="language-python"># SGD with momentum
keras.optimizers.SGD(learning_rate=0.01, momentum=0.9, nesterov=True)

# Adam variants
keras.optimizers.Adam(learning_rate=0.001, beta_1=0.9, beta_2=0.999)
keras.optimizers.AdamW(learning_rate=0.001, weight_decay=0.01)
keras.optimizers.Adamax(learning_rate=0.002)

# Other optimizers
keras.optimizers.RMSprop(learning_rate=0.001, rho=0.9)
keras.optimizers.Adagrad(learning_rate=0.01)
keras.optimizers.Adadelta(learning_rate=1.0, rho=0.95)
</code></pre>
<h3 id="learning-rate-schedules">Learning Rate Schedules</h3>
<pre><code class="language-python"># Exponential decay
lr_schedule = keras.optimizers.schedules.ExponentialDecay(
    initial_learning_rate=0.1,
    decay_steps=10000,
    decay_rate=0.9
)

# Cosine decay
lr_schedule = keras.optimizers.schedules.CosineDecay(
    initial_learning_rate=0.1,
    decay_steps=1000
)

# Piecewise constant
lr_schedule = keras.optimizers.schedules.PiecewiseConstantDecay(
    boundaries=[100000, 110000],
    values=[1.0, 0.5, 0.1]
)

optimizer = keras.optimizers.Adam(learning_rate=lr_schedule)
</code></pre>
<h2 id="loss-functions">Loss Functions</h2>
<h3 id="classification">Classification</h3>
<pre><code class="language-python">keras.losses.BinaryCrossentropy()
keras.losses.BinaryFocalCrossentropy(alpha=0.25, gamma=2.0)
keras.losses.CategoricalCrossentropy()
keras.losses.SparseCategoricalCrossentropy()
keras.losses.KLDivergence()
</code></pre>
<h3 id="regression">Regression</h3>
<pre><code class="language-python">keras.losses.MeanSquaredError()
keras.losses.MeanAbsoluteError()
keras.losses.MeanAbsolutePercentageError()
keras.losses.MeanSquaredLogarithmicError()
keras.losses.Huber(delta=1.0)
</code></pre>
<h3 id="custom-loss">Custom Loss</h3>
<pre><code class="language-python">def custom_loss(y_true, y_pred):
    return ops.mean(ops.square(y_true - y_pred))

# Or as a class
class CustomLoss(keras.losses.Loss):
    def __init__(self, name=&quot;custom_loss&quot;):
        super().__init__(name=name)

    def call(self, y_true, y_pred):
        return ops.mean(ops.square(y_true - y_pred))

model.compile(optimizer='adam', loss=CustomLoss())
</code></pre>
<h2 id="training">Training</h2>
<h3 id="basic-training">Basic Training</h3>
<pre><code class="language-python">history = model.fit(
    x_train, y_train,
    batch_size=32,
    epochs=10,
    validation_data=(x_val, y_val),
    verbose=1
)
</code></pre>
<h3 id="advanced-training-with-callbacks">Advanced Training with Callbacks</h3>
<pre><code class="language-python">callbacks = [
    keras.callbacks.EarlyStopping(
        monitor='val_loss',
        patience=3,
        restore_best_weights=True
    ),
    keras.callbacks.ReduceLROnPlateau(
        monitor='val_loss',
        factor=0.2,
        patience=2,
        min_lr=0.001
    ),
    keras.callbacks.ModelCheckpoint(
        filepath='best_model.keras',
        monitor='val_accuracy',
        save_best_only=True,
        verbose=1
    ),
    keras.callbacks.TensorBoard(
        log_dir='./logs',
        histogram_freq=1,
        write_graph=True
    )
]

history = model.fit(
    x_train, y_train,
    validation_data=(x_val, y_val),
    epochs=50,
    callbacks=callbacks,
    verbose=1
)
</code></pre>
<h3 id="custom-training-step">Custom Training Step</h3>
<pre><code class="language-python">class CustomModel(keras.Model):
    def train_step(self, data):
        x, y = data

        with keras.backends.gradienttape() as tape:
            y_pred = self(x, training=True)
            loss = self.compute_loss(x, y, y_pred)

        trainable_vars = self.trainable_variables
        gradients = tape.gradient(loss, trainable_vars)
        self.optimizer.apply_gradients(zip(gradients, trainable_vars))

        for metric in self.metrics:
            if metric.name == &quot;loss&quot;:
                metric.update_state(loss)
            else:
                metric.update_state(y, y_pred)

        return {m.name: m.result() for m in self.metrics}
</code></pre>
<h2 id="data-processing">Data Processing</h2>
<h3 id="image-data-loading-and-augmentation">Image Data Loading and Augmentation</h3>
<pre><code class="language-python"># Create a dataset from a directory of images
train_ds = keras.utils.image_dataset_from_directory(
    directory='train_directory',
    labels='inferred',
    label_mode='categorical',
    batch_size=32,
    image_size=(224, 224)
)

# Define data augmentation layers
data_augmentation = keras.Sequential([
    layers.RandomFlip(&quot;horizontal&quot;),
    layers.RandomRotation(0.1),
    layers.RandomZoom(0.1),
])

# Apply augmentation to the dataset
train_ds = train_ds.map(lambda x, y: (data_augmentation(x), y))

# Prefetch for performance
train_ds = train_ds.prefetch(buffer_size=tf.data.AUTOTUNE)

# Fit with the dataset
model.fit(train_ds, epochs=10, validation_data=val_ds)
</code></pre>
<h3 id="tfdata-integration">tf.data Integration</h3>
<pre><code class="language-python"># Using tf.data with Keras
import tensorflow as tf

def preprocess(image, label):
    image = tf.cast(image, tf.float32) / 255.0
    return image, label

train_ds = tf.data.Dataset.from_tensor_slices((x_train, y_train))
train_ds = train_ds.map(preprocess).batch(32).prefetch(tf.data.AUTOTUNE)

model.fit(train_ds, epochs=10)
</code></pre>
<h2 id="evaluation-and-prediction">Evaluation and Prediction</h2>
<h3 id="model-evaluation">Model Evaluation</h3>
<pre><code class="language-python"># Evaluate on test set
test_loss, test_accuracy = model.evaluate(x_test, y_test, verbose=0)
print(f&quot;Test accuracy: {test_accuracy:.4f}&quot;)

# Detailed evaluation with multiple metrics
results = model.evaluate(
    x_test, y_test,
    batch_size=32,
    return_dict=True,
    verbose=1
)
</code></pre>
<h3 id="predictions">Predictions</h3>
<pre><code class="language-python"># Predictions
predictions = model.predict(x_test)
predicted_classes = np.argmax(predictions, axis=1)

# Single prediction
single_pred = model.predict(np.expand_dims(single_sample, axis=0))

# Prediction with custom batch size
predictions = model.predict(x_test, batch_size=64, verbose=1)
</code></pre>
<h2 id="model-persistence">Model Persistence</h2>
<h3 id="saveload-model">Save/Load Model</h3>
<pre><code class="language-python"># Save entire model
model.save('my_model.keras')  # Recommended format
model.save('my_model.h5')     # Legacy format

# Load model
loaded_model = keras.models.load_model('my_model.keras')

# Save/load weights only
model.save_weights('weights.weights.h5')
model.load_weights('weights.weights.h5')
</code></pre>
<h3 id="export-to-different-formats">Export to Different Formats</h3>
<pre><code class="language-python"># SavedModel format (for TensorFlow Serving)
model.export('saved_model_dir')

# Load exported model
imported_model = keras.models.load_model('saved_model_dir')
</code></pre>
<h2 id="callbacks">Callbacks</h2>
<h3 id="built-in-callbacks">Built-in Callbacks</h3>
<pre><code class="language-python"># Early stopping
keras.callbacks.EarlyStopping(
    monitor='val_loss',
    patience=5,
    restore_best_weights=True,
    verbose=1
)

# Learning rate scheduling
keras.callbacks.LearningRateScheduler(
    lambda epoch: 0.1 * 0.95 ** epoch
)

# CSV logger
keras.callbacks.CSVLogger('training.log')

# Model checkpointing
keras.callbacks.ModelCheckpoint(
    'model_{epoch:02d}_{val_loss:.2f}.keras',
    save_best_only=True,
    monitor='val_loss',
    mode='min'
)
</code></pre>
<h3 id="custom-callbacks">Custom Callbacks</h3>
<pre><code class="language-python">class CustomCallback(keras.callbacks.Callback):
    def on_epoch_begin(self, epoch, logs=None):
        print(f&quot;Starting epoch {epoch}&quot;)

    def on_epoch_end(self, epoch, logs=None):
        if logs.get('val_accuracy') &gt; 0.95:
            print(&quot;Reached 95% accuracy, stopping training!&quot;)
            self.model.stop_training = True

    def on_batch_end(self, batch, logs=None):
        if batch % 100 == 0:
            print(f&quot;Finished batch {batch}&quot;)

model.fit(x_train, y_train, callbacks=[CustomCallback()])
</code></pre>
<h2 id="metrics">Metrics</h2>
<h3 id="built-in-metrics">Built-in Metrics</h3>
<pre><code class="language-python"># Classification metrics
keras.metrics.Accuracy()
keras.metrics.BinaryAccuracy()
keras.metrics.CategoricalAccuracy()
keras.metrics.SparseCategoricalAccuracy()
keras.metrics.TopKCategoricalAccuracy(k=5)
keras.metrics.Precision()
keras.metrics.Recall()
keras.metrics.F1Score()
keras.metrics.AUC()

# Regression metrics
keras.metrics.MeanSquaredError()
keras.metrics.MeanAbsoluteError()
keras.metrics.RootMeanSquaredError()
keras.metrics.MeanAbsolutePercentageError()
</code></pre>
<h3 id="custom-metrics">Custom Metrics</h3>
<pre><code class="language-python">class F1Score(keras.metrics.Metric):
    def __init__(self, name='f1_score', **kwargs):
        super().__init__(name=name, **kwargs)
        self.precision = keras.metrics.Precision()
        self.recall = keras.metrics.Recall()

    def update_state(self, y_true, y_pred, sample_weight=None):
        self.precision.update_state(y_true, y_pred, sample_weight)
        self.recall.update_state(y_true, y_pred, sample_weight)

    def result(self):
        p = self.precision.result()
        r = self.recall.result()
        return 2 * ((p * r) / (p + r + keras.backend.epsilon()))

    def reset_state(self):
        self.precision.reset_state()
        self.recall.reset_state()
</code></pre>
<h2 id="transfer-learning">Transfer Learning</h2>
<h3 id="using-pre-trained-models">Using Pre-trained Models</h3>
<pre><code class="language-python"># Load pre-trained model without top layers
base_model = keras.applications.VGG16(
    weights='imagenet',
    include_top=False,
    input_shape=(224, 224, 3)
)

# Freeze base model
base_model.trainable = False

# Add custom head
inputs = keras.Input(shape=(224, 224, 3))
x = base_model(inputs, training=False)
x = layers.GlobalAveragePooling2D()(x)
x = layers.Dense(128, activation='relu')(x)
outputs = layers.Dense(num_classes, activation='softmax')(x)

model = keras.Model(inputs, outputs)

# Fine-tuning: unfreeze some layers
base_model.trainable = True
for layer in base_model.layers[:-4]:
    layer.trainable = False
</code></pre>
<h2 id="advanced-features">Advanced Features</h2>
<h3 id="mixed-precision-training">Mixed Precision Training</h3>
<pre><code class="language-python"># Enable mixed precision
keras.mixed_precision.set_global_policy('mixed_float16')

# Custom model with loss scaling
class MixedPrecisionModel(keras.Model):
    def __init__(self, *args, **kwargs):
        super().__init__(*args, **kwargs)
        self.loss_tracker = keras.metrics.Mean(name=&quot;loss&quot;)

    def train_step(self, data):
        x, y = data

        with keras.backend.gradienttape() as tape:
            y_pred = self(x, training=True)
            loss = self.compute_loss(x, y, y_pred)
            # Scale loss for mixed precision
            scaled_loss = self.optimizer.get_scaled_loss(loss)

        scaled_gradients = tape.gradient(scaled_loss, self.trainable_variables)
        gradients = self.optimizer.get_unscaled_gradients(scaled_gradients)
        self.optimizer.apply_gradients(zip(gradients, self.trainable_variables))

        self.loss_tracker.update_state(loss)
        return {&quot;loss&quot;: self.loss_tracker.result()}
</code></pre>
<h3 id="custom-layers">Custom Layers</h3>
<pre><code class="language-python">class CustomDense(layers.Layer):
    def __init__(self, units=32, **kwargs):
        super().__init__(**kwargs)
        self.units = units

    def build(self, input_shape):
        self.w = self.add_weight(
            shape=(input_shape[-1], self.units),
            initializer='random_normal',
            trainable=True,
            name='kernel'
        )
        self.b = self.add_weight(
            shape=(self.units,),
            initializer='zeros',
            trainable=True,
            name='bias'
        )
        super().build(input_shape)

    def call(self, inputs):
        return ops.matmul(inputs, self.w) + self.b

    def get_config(self):
        config = super().get_config()
        config.update({&quot;units&quot;: self.units})
        return config
</code></pre>
<h3 id="model-visualization">Model Visualization</h3>
<pre><code class="language-python"># Plot model architecture
keras.utils.plot_model(
    model,
    to_file='model.png',
    show_shapes=True,
    show_layer_names=True,
    rankdir='TB',
    dpi=96
)

# Model summary
model.summary()

# Layer-wise summary
for i, layer in enumerate(model.layers):
    print(f&quot;Layer {i}: {layer.name} ({layer.__class__.__name__})&quot;)
    print(f&quot;  Input shape: {layer.input_shape}&quot;)
    print(f&quot;  Output shape: {layer.output_shape}&quot;)
    print(f&quot;  Parameters: {layer.count_params()}&quot;)
</code></pre>
<h2 id="hyperparameter-tuning-with-kerastuner">Hyperparameter Tuning with KerasTuner</h2>
<pre><code class="language-python"># Install: pip install keras-tuner

import keras_tuner

def build_model(hp):
    model = keras.Sequential([
        layers.Dense(
            hp.Int('units_1', 32, 512, step=32),
            activation='relu'
        ),
        layers.Dropout(hp.Float('dropout_1', 0, 0.5, step=0.1)),
        layers.Dense(
            hp.Int('units_2', 32, 512, step=32),
            activation='relu'
        ),
        layers.Dense(10, activation='softmax')
    ])

    model.compile(
        optimizer=keras.optimizers.Adam(
            hp.Float('learning_rate', 1e-4, 1e-2, sampling='log')
        ),
        loss='sparse_categorical_crossentropy',
        metrics=['accuracy']
    )
    return model

tuner = keras_tuner.RandomSearch(
    build_model,
    objective='val_accuracy',
    max_trials=20
)

tuner.search(x_train, y_train, epochs=5, validation_data=(x_val, y_val))
best_model = tuner.get_best_models()[0]
</code></pre>
<h2 id="kerashub-and-kerascv">KerasHub and KerasCV</h2>
<h3 id="kerashub-nlp">KerasHub (NLP)</h3>
<pre><code class="language-python"># Install: pip install keras-hub

import keras_hub

# Text classification with BERT
classifier = keras_hub.models.BertClassifier.from_preset(
    &quot;bert_base_en_uncased&quot;,
    num_classes=2
)

# Text generation with GPT
generator = keras_hub.models.GPT2CausalLM.from_preset(&quot;gpt2_base_en&quot;)
output = generator.generate(&quot;The weather today&quot;, max_length=50)
</code></pre>
<h3 id="kerascv-computer-vision">KerasCV (Computer Vision)</h3>
<pre><code class="language-python"># Install: pip install keras-cv

import keras_cv

# Data augmentation
augment = keras_cv.layers.RandAugment(
    value_range=(0, 255),
    magnitude=0.5,
    augmentations_per_image=3
)

# Object detection
detector = keras_cv.models.RetinaNet.from_preset(
    &quot;retinanet_resnet50_pascalvoc&quot;
)
</code></pre>
<h2 id="debugging-and-performance">Debugging and Performance</h2>
<h3 id="debugging">Debugging</h3>
<pre><code class="language-python"># Enable eager execution for debugging
# tf.config.run_functions_eagerly(True)  # For TensorFlow backend

# Add debug prints in custom layers/models
class DebugLayer(layers.Layer):
    def call(self, inputs):
        keras.utils.print_msg(f&quot;Input shape: {ops.shape(inputs)}&quot;)
        return inputs

# Check for NaN values
def check_nan(tensor, name):
    if ops.any(ops.isnan(tensor)):
        print(f&quot;NaN detected in {name}&quot;)
    return tensor
</code></pre>
<h3 id="performance-optimization">Performance Optimization</h3>
<pre><code class="language-python"># Use mixed precision
keras.mixed_precision.set_global_policy('mixed_float16')

# Enable XLA compilation (TensorFlow backend)
# model.compile(optimizer='adam', loss='mse', jit_compile=True)

# Profile training
# keras.utils.Progbar for custom progress bars
# Use TensorBoard for performance profiling

# Memory optimization
keras.backend.clear_session()  # Clear session to free memory
</code></pre>
<h2 id="best-practices">Best Practices</h2>
<ol>
<li><strong>Model Design</strong>: Start simple, add complexity gradually</li>
<li><strong>Data</strong>: Normalize inputs, use data augmentation for images</li>
<li><strong>Training</strong>: Use callbacks for early stopping and learning rate scheduling</li>
<li><strong>Validation</strong>: Always use validation data to monitor overfitting</li>
<li><strong>Reproducibility</strong>: Set random seeds and use <code>keras.utils.set_random_seed()</code></li>
<li><strong>Save Models</strong>: Use <code>.keras</code> format for better compatibility</li>
<li><strong>Backend Choice</strong>: JAX for research, TensorFlow for production, PyTorch for flexibility</li>
<li><strong>Memory Management</strong>: Use <code>keras.backend.clear_session()</code> to free memory</li>
<li><strong>Debugging</strong>: Use model summaries and visualization tools</li>
<li><strong>Performance</strong>: Use mixed precision and appropriate batch sizes</li>
</ol>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.1e8ae164.min.js"></script>
      
        <script src="../../search/main.js"></script>
      
    
  </body>
</html>